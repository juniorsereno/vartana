<div class="space-y-4">
  <div class="p-4 bg-surface rounded-lg border border-gray-200 space-y-3">
    <h4 class="font-medium text-primary flex items-center gap-2">
      <%= icon "wallet", class: "w-5 h-5 text-green-500" %>
      <%= t("settings.providers.simplefin.title") %>
    </h4>
    <p class="text-sm text-secondary">
      <%= t("settings.providers.simplefin.description") %>
    </p>
    <ul class="text-sm text-secondary list-disc pl-5 space-y-1">
      <li><%= t("settings.providers.simplefin.instructions.step_1") %></li>
      <li><%= t("settings.providers.simplefin.instructions.step_2") %></li>
      <li><%= t("settings.providers.simplefin.instructions.step_3") %></li>
    </ul>
  </div>

  <div class="prose prose-sm text-secondary">
    <p class="text-primary font-medium"><%= t("settings.providers.simplefin.field_descriptions.title") %></p>
    <ul>
      <li><strong><%= t("settings.providers.simplefin.field_descriptions.setup_token.label") %>:</strong> <%= t("settings.providers.simplefin.field_descriptions.setup_token.description") %></li>
    </ul>
  </div>

  <% if defined?(@error_message) && @error_message.present? %>
    <div class="p-2 rounded-md bg-destructive/10 text-destructive text-sm overflow-hidden">
      <p class="line-clamp-3" title="<%= @error_message %>"><%= @error_message %></p>
    </div>
  <% end %>

  <%= styled_form_with model: SimplefinItem.new,
                       url: simplefin_items_path,
                       scope: :simplefin_item,
                       method: :post,
                       data: { turbo: true },
                       class: "space-y-3" do |form| %>
    <%= form.text_field :setup_token,
                        label: "Setup Token",
                        placeholder: "Paste SimpleFIN setup token",
                        type: :password %>

    <div class="flex justify-end">
      <%= form.submit t("settings.providers.simplefin.save"),
                      class: "inline-flex items-center justify-center rounded-lg px-4 py-2 text-sm font-medium text-white bg-gray-900 hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2 transition-colors" %>
    </div>
  <% end %>

  <div class="flex items-center gap-2">
    <% if @simplefin_items&.any? %>
      <div class="w-2 h-2 bg-success rounded-full"></div>
      <p class="text-sm text-secondary">Configured and ready to use. Visit the <a href="<%= accounts_path %>" class="link">Accounts</a> tab to manage and set up accounts.</p>
    <% else %>
      <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
      <p class="text-sm text-secondary">Not configured</p>
    <% end %>
  </div>
</div>
